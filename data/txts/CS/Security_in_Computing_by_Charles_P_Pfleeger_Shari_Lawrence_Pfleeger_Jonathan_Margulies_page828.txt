794 Chapter 12  
Details of Cryptographythe initialization vector we described with DES. In some implementations of RC4 the 
nonce is appended to the key, effectively extending and randomizing the key.
Fluhrer et al. [FLU01] analyzed the output of RC4 for all possible keys and found 
that the output is biased, leaking information about the key. If the nonce has been 

appended to the key, it is possible to narrow the search space for the key significantly.
RC4 is widely used for WEP encryption on wireless networks. The wireless access 
point and remote device use the same key indefinitely until manually rekeyed. The 

weakness Fluhrer et al. identified has allowed WEP encryption to be broken in minutes. 

This weakness led to the development of WPA and WPA2 for wireless communication, 

the latter using the much stronger AES encryption.
In March 2012, a team of researchers at Royal Hollowayâ€“University of London and 
University of Illinois [ALF13] disclosed new attacks against TLS (described in Chap-

ter 6 along with its predecessor SSL) that allows an attacker to recover a limited amount 

of plaintext from a TLS connection when RC4 encryption is used. The attacks arise 

from statistical flaws in the keystream generated by the RC4 algorithm which become 

apparent in TLS ciphertexts when the same plaintext is repeatedly encrypted. Later in 

2012, revelations from a former NSA employee indicated NSA and other intelligence 

agencies might have the capability to break RC4 encryption. Consequently, Microsoft 

[MIC13] recommended that customers discontinue using RC4.TLS security and especially its predecessor SSL (encryption invoked under the https 
protocol) can also use RC4, although browsers give users the option of choosing or 

disallowing any particular algorithm.
RC4 has also been used in Microsoft Office products Word and Excel to encrypt 
password-protected documents. Microsoft makes the mistake of encrypting each ver-

sion of a document under the same encryption key (password). Wu [WU05] describes 

an attack like the XOR stream attack described above by which the text of an encrypted 

document can easily be retrieved, given two versions of the document.
RC5RC5 is a fully parameterized block cipher; this means the key length, block size, and 
number of cycles can be varied to alter the balance between security and complexity 

of operation and use. RC5 [RIV94] uses a simple design that served as a model for the 

AES candidate RC6.A data block in RC5 is split in half, the left half is modified, the halves are swapped, 
the new left half (that is, the old right half) is modified the same way, and the halves 

are swapped again. That sequence constitutes a full round of the algorithm. The modi-

fications of each half-round involve XOR, circular shift, and addition of a portion of 

the key. In an unusual twist for a cryptographic algorithm, the number of bits shifted 

depends on the input data: The left half is shifted by the number of bits of the value of 

the right half.No significant weaknesses have been found in RC5. Encryption with a small number 
(12) of rounds has been found to be subject to differential cryptanalysis, but the number 

of rounds can be set arbitrarily. Because the operations per round are few and simple 

and the speed of the implementation depends linearly on the number of rounds, raising 
the number of rounds above 12 does not significantly slow encryption.
